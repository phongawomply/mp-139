machine:
  post:
    - npm install -g gulp
    - npm install -g protractor
    - npm install -g codeclimate-test-reporter

dependencies:
  pre:
    - |
      npm login <<!
      $NPM_USERNAME
      $NPM_PASSWORD
      $NPM_EMAIL!
  override:
    - sudo apt-get update
    - sudo apt-get install google-chrome-stable
    - npm install

test:
  pre:
    - git config --global user.name 'deploy'
    - git config --global user.email 'devs@womply.com'
  override:
    - gulp blueprints:
        background: true
    - gulp serve:
        background: true
    - gulp test:karma:dev
    - codeclimate-test-reporter < ./coverage/lcov.info

# TODO: Uncomment the deployment stanza below to get CircleCI deploys working.
#
# deployment:
#   everywhere:
#     branch: /(master|develop)/
#     commands:
#       - gulp build
#       - sudo pip install --upgrade awscli
#       - bin/deploy $CIRCLE_BRANCH
